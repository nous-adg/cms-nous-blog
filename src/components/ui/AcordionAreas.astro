---
import type { AccordionItem } from "../../types/accordion";
import AccordionItems from "./accordion/AccordionItem.astro";

const accordionItems: AccordionItem[] = [
  {
    id: "derecho-administrativo",
    title: "Derecho Administrativo",
    description:
      "La práctica de Randall Solano Fallas acompaña a personas y organizaciones en su relación con ministerios, municipalidades, entes reguladores y órganos desconcentrados. Se prioriza la prevención de contingencias y, cuando corresponde, la defensa técnica del expediente.",
    services: [
      "Asesoría y representación ante la Administración Pública: criterios, permisos.",
      "Procesos sancionatorios y recursos, con enfoque preventivo y estratégico.",
      "Tramitología y apertura de negocios.",
      "Procesos administrativos sancionatorios y disciplinarios",
      "Litigio Administrativo y Contencioso Administrativo.",
    ],
  },
  {
    id: "contratacion-publica",
    title: "Contratación Pública",
    description:
      "La práctica apoya a proveedores y entidades públicas en procedimientos de compra con rigor técnico y enfoque práctico.",
    services: [
      "Creamos en conjunto una Estrategia integral para contratar con el Estado, los servicios de consultoría incluyen: análisis de cartel, ofertas, presentación y redacción de recursos de objeciones/revocatoria y apelación.",
      "Ejecución contractual (incluido SICOP).",
      "Litigio Administrativo y en los Tribunales Contencioso Administrativo.",
    ],
  },
  {
    id: "procesos-tributarios",
    title: "Procesos Tributarios",
    description:
      "La práctica acompaña a contribuyentes en prevención y defensa a lo largo del ciclo tributario.",
    services: [
      "Planificación y defensa tributaria: fiscalizaciones, requerimientos, recursos, procesos de regularización",
      "Litigio Contencioso Administrativo.",
    ],
  },
  {
    id: "litigio-contencioso-administrativo",
    title: "Litigio Contencioso-Administrativo",
    description:
      "Cuando la vía administrativa resulta insuficiente, la práctica litiga ante la jurisdicción contencioso-administrativa con una teoría del caso clara y gestión probatoria cuidadosa.",
    services: [
      "Representación en todo el proceso de litigio en los Tribunales Contencioso Administrativo y Casación.",
      "Presentación de Demanda u otras Acciones Judiciales.",
      "Acciones de nulidad, medidas cautelares, ",
      "Procesos de responsabilidad del Estado.",
      "Controversias contractuales administrativas.",
    ],
  },
  {
    id: "compliance-and-risk",
    title: "Compliance and Risk",
    description:
      "El cumplimiento eficaz reduce sanciones, fraudes y conflictos con reguladores y fortalece la confianza de clientes y socios. La práctica diseña e implementa programas ajustados al tamaño y sector de cada organización.",
    services: [
      "Programas de cumplimiento proporcionales al riesgo: políticas, debida diligencia, canal de denuncias, monitoreo y respuesta a incidentes.",
      "Gestión y tramitación de denuncias por corrupción",
      "Construcción de un Código de Ética",
    ],
  },
  {
    id: "regimenes-especiales",
    title: "Regímenes Especiales",
    description:
      "Algunos proyectos requieren marcos diferenciados. La práctica diseña y acompaña esquemas como concesiones, alianzas público-privadas, fideicomisos públicos, convenios interadministrativos y compras bajo excepción.",
      services: [
        "Asesoría y Consultoría en:",
        "El Régimen de Zonas Francas.",
        "Regímenes Especiales.",
        "Análisis previo a autorías PROCOMER.",
        "Gestión de Cumplimiento.",
      ],
  },
  {
    id: "derecho-corporativo",
    title: "Derecho Corporativo",
    description:
      "La práctica asesora a emprendimientos y empresas durante todo el ciclo corporativo: constitución, gobierno corporativo, pactos de socios, contratación comercial y prevención de conflictos.",
      services: [
        "Gobernanza y contratación para negocios:",
        "estructuración societaria, acuerdos entre socios y contratos claros y ejecutables.",
        "Consultoría en la gestión empresarial y comercial.",
        "Gobierno Corporativo",
      ],
  },
  {
    id: "derecho-laboral",
    title: "Derecho Laboral",
    description:
      "La práctica de Randall Solano Fallas acompaña a personas y organizaciones en su relación con ministerios, municipalidades, entes reguladores y órganos desconcentrados. Se prioriza la prevención de contingencias y, cuando corresponde, la defensa técnica del expediente.",
    services: [
      "Consultoria y Asesoria sobre las normas que rigen el derecho laboral tomando en cuenta la actividad económica de la empresa.",
      "Asesoria en la redacción de contratos, gestión de la relación laboral, redacción de código ético, reglamentos internos. Procesos Disciplinarios. Esquemas de remuneración. Litigio Judicial Laboral.",
    ],
  }
];
---

<section class="container mx-auto px-4 md:px-6 lg:px-4 max-w-7xl">
  <article class="bg-secondary rounded-xl p-3 md:p-6 text-primary">
    <div class="accordion-container space-y-2 md:space-y-4">
      {
        accordionItems.map((item, index) => (
          <AccordionItems id={item.id} item={item} index={index} />
        ))
      }
    </div>
  </article>
</section>

<script>
  // Accordion functionality
  document.addEventListener("astro:page-load", () => {
    const accordionTriggers = document.querySelectorAll(
      "[data-accordion-trigger]"
    );

    accordionTriggers.forEach((trigger) => {
      trigger.addEventListener("click", () => {
        const content = trigger.nextElementSibling as HTMLElement;
        const icon = trigger.querySelector(".accordion-icon");
        const isExpanded = trigger.getAttribute("aria-expanded") === "true";

        // Close all other accordions
        accordionTriggers.forEach((otherTrigger) => {
          if (otherTrigger !== trigger) {
            const otherContent = otherTrigger.nextElementSibling as HTMLElement;
            const otherIcon = otherTrigger.querySelector(".accordion-icon");

            otherTrigger.setAttribute("aria-expanded", "false");
            otherContent?.setAttribute("aria-hidden", "true");
            otherContent?.classList.remove("max-h-[2000px]");
            otherContent?.classList.add("max-h-0");
            otherIcon?.classList.remove("rotate-180");
            // Remove background color
            otherTrigger.classList.remove("bg-primary", "rounded-lg");
            // Reset text colors
            const otherTitle = otherTrigger.querySelector("h3");
            const otherDescription = otherTrigger.querySelector("p");
            otherTitle?.classList.remove("text-secondary");
            otherTitle?.classList.add("text-primary");
            otherDescription?.classList.remove("text-secondary");
            otherDescription?.classList.add("text-primary");
          }
        });

        // Toggle current accordion
        if (isExpanded) {
          trigger.setAttribute("aria-expanded", "false");
          content?.setAttribute("aria-hidden", "true");
          content?.classList.remove("max-h-[2000px]");
          content?.classList.add("max-h-0");
          icon?.classList.remove("rotate-180");
          // Remove background color
          trigger.classList.remove("bg-primary", "rounded-lg");
          // Reset text colors
          const title = trigger.querySelector("h3");
          const description = trigger.querySelector("p");
          title?.classList.remove("text-secondary");
          title?.classList.add("text-primary");
          description?.classList.remove("text-secondary");
          description?.classList.add("text-primary");
        } else {
          trigger.setAttribute("aria-expanded", "true");
          content?.setAttribute("aria-hidden", "false");
          content?.classList.remove("max-h-0");
          content?.classList.add("max-h-[2000px]");
          icon?.classList.add("rotate-180");
          // Add background color
          trigger.classList.add("bg-primary", "rounded-t-lg");
          // Change text colors to secondary (dark)
          const title = trigger.querySelector("h3");
          const description = trigger.querySelector("p");
          title?.classList.remove("text-primary");
          title?.classList.add("text-secondary");
          description?.classList.remove("text-primary");
          description?.classList.add("text-secondary");
        }
      });
    });
  });
</script>
